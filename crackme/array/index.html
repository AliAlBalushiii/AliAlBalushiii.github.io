<!doctype html>
<html lang="en" class="no-js">
<head>
  <meta charset="utf-8">
  <title>Writeup Overview â€“ Array Target - Ali Al Balushiâ€™s Blog</title>

  <meta name="description" content="Array crackme by winapiadmin with anti-debugging techniques">
  <meta name="author" content="Ali Al Balushi">

  <meta property="og:type" content="article">
  <meta property="og:locale" content="en">
  <meta property="og:site_name" content="Ali Al Balushi Blog">
  <meta property="og:title" content="Writeup Overview â€“ Array Target">
  <meta property="og:url" content="https://alialbalushiii.github.io/crackme/array/">
  <meta property="og:description" content="Array crackme writeup with reverse engineering walkthrough">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script>
    document.documentElement.className =
      document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  </script>

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="preload"
        href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"
        as="style"
        onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
  </noscript>
</head>

<body class="layout--single wide">

<div class="masthead">
  <div class="masthead__inner-wrap">
    <nav class="greedy-nav">
      <a class="site-title" href="/">Ali Al Balushi's Blog</a>
      <ul class="visible-links">
        <li class="masthead__menu-item"><a href="/about">About</a></li>
      </ul>
    </nav>
  </div>
</div>

<div class="initial-content">
<div id="main" role="main">

<article class="page h-entry">
<div class="page__inner-wrap">

<header>
  <h1 class="page__title">Writeup Overview â€“ Array Target</h1>
  <p class="page__meta">
    <span><i class="far fa-calendar-alt"></i> Nov 13, 2023</span>
    <span class="page__meta-sep"></span>
    <span><i class="far fa-clock"></i> 4 minute read</span>
  </p>
</header>

<!-- ================= CONTENT START ================= -->

<section class="page__content e-content">

<h2>winapiadmin (Array) â€“ Target</h2>

<ul>
  <li><strong>Name:</strong> Array</li>
  <li><strong>Author:</strong> winapiadmin</li>
  <li><strong>Platform:</strong> Windows</li>
  <li><strong>Architecture:</strong> x86-64</li>
  <li><strong>Language:</strong> C / C++</li>
  <li><strong>Difficulty:</strong> 2.0 (Beginner) ğŸŸ¡</li>
  <li><strong>Quality:</strong> 4.0 â­</li>
  <li><strong>Upload Date:</strong> 2023-11-13</li>
  <li><strong>Description:</strong> Some array crackmes with anti-debugging.</li>
</ul>

<hr>

<p><strong>First, I start by running the target:</strong></p>
<img src="/images/crackme/array/1.png" alt="Run target">

<p>It asks for a username and password.</p>

<hr>

<p>
Next, I load the binary into <strong>IDA Pro</strong> and decompile
the <code>main()</code> function:
</p>
<img src="/images/crackme/array/2.png" alt="main function">

<ul>
  <li>
    <strong>Username buffer:</strong>
    <img src="/images/crackme/array/3.png">
  </li>
  <li>
    <strong>Password string:</strong>
    <img src="/images/crackme/array/4.png">
  </li>
</ul>

<hr>

<p>
The password is interpreted as a 64-bit integer:
</p>
<img src="/images/crackme/array/5.png">

<hr>

<p>
<strong>This conditional block decides validation:</strong>
</p>
<img src="/images/crackme/array/6.png">

<pre><code>v8.m128i_i64[Buffer[0] % 2] % 64</code></pre>

<hr>

<h3>Understanding <code>v8</code></h3>

<img src="/images/crackme/array/7.png">

<p>
The 128-bit value is:
</p>

<pre><code>6F6C6C654821646C726F57202C000000h</code></pre>

<p>
Split into two 64-bit values:
</p>

<img src="/images/crackme/array/8.png">
<img src="/images/crackme/array/9.png">

<hr>

<p>
Username first character decides the index:
</p>

<ul>
  <li>Even ASCII â†’ <code>v8[0]</code></li>
  <li>Odd ASCII â†’ <code>v8[1]</code></li>
</ul>

<img src="/images/crackme/array/10.png">

<hr>

<p>
Final step applies <code>% 64</code> (lowest 6 bits).
</p>

<img src="/images/crackme/array/11.png">

<p>
Binary <code>101100</code> â†’ Decimal <strong>44</strong>
</p>

<hr>

<p>
Using username <strong>B</strong> and password <strong>44</strong>:
</p>

<img src="/images/crackme/array/12.png">

<p><strong>âœ” Success â€“ License Accepted</strong></p>

<hr>

<p>ğŸš€ Thanks for following the writeup.</p>

</section>

<!-- ================= CONTENT END ================= -->

</div>
</article>
</div>
</div>

<script src="/assets/js/main.min.js"></script>

</body>
</html>
